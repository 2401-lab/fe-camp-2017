### JavaScript高级程序设计读书笔记	2018.02.02

[TOC]

#### 1. script

##### 1.1 script标签的六个属性
- async
  可选
  表示应该立即下载脚本，但不应妨碍页面中的其他操作，比如下载其他资源或等待加载其他脚本。只对外部脚本文件有效。

- charset
  可选
  表示通过src属性指定的代码的字符串。由于大多数浏览器会忽略它的值，因此少用。

- defer
  可选
  表示脚本可以延迟到文档完全被解析和显示之后再执行。只对外部脚本文件有效。

- language
  已废弃。原来用于表示编写代码使用的脚本语言（JS或VBScript等）。大多数浏览器会忽略这个属性，因此没有必要再用。

- src
  可选
  表示包含要执行代码的外部文件。

- type
  可选
  可以看做language的替代属性。表示编写代码使用的脚本语言的内容类型（也称为MIME类型）。考虑到约定俗成和最大限度的浏览器兼容性，目前type属性的值依旧为text/javascript。不过这个属性并不是必须的，如果没有指定这个属性，则其默认值依旧为text/javascript

##### 1.2 script元素使用方式
- 直接在页面中嵌入JavaScript代码
- 包含外部JavaScript代码文件

在使用`<script>`嵌入JavaScript代码时，只需指定type属性，将代码放入标签内部
```
<script type="text/javascript">
	function sayHi(){
    	alert("Hi!");
    }
</script>
```
包含在`<script>`元素内部的JavaScript代码将被从上至下依次解释。上例中解释器会解释一个函数的定义，然后将该定义保存在自己的环境中。
**
在解释器对`<script>`元素内部的所有代码求值完毕以前，页面中的其余内容都不会被浏览器加载或显示
在使用`<script>`嵌入JavaScript代码时，记住不要在代码中的任何地方出现`</script>`字符串
**
```
<script type="text/javascript">
	function sayScript(){
    	alert("</script>");
    }
</script>
```
上述代码会产生错误，按照解析嵌入式代码的规则，浏览器遇到结束标签字符时会认为是结束标签。引入转义字符可以解决这个问题。

如果要通过`<script>`元素来包含外部JavaScript文件，src属性是必须的，src = "外部JS文件"
**
在解析外部JavaScript文件（包括下载该文件）时，页面的处理也会暂时停止。
另外如果包含了嵌入的代码，则嵌入的代码会被忽略。
src属性可以是指向当前HTML页面所在域之外的某个域中的完整URL
不存在defer和async属性，按照`<script>`元素在页面中的先后顺序依次解析。
**

###### 1.2.1 标签的位置
**浏览器在遇到`<body>`标签时才开始呈现内容，延迟期间页面一片空白。
一般把全部JavaScript引用放在`<body>`元素中页面内容的后面。
这样在解析包含的JavaScript代码之前，页面的内容将完全呈现在浏览器中。**

###### 1.2.2 延迟脚本
**defer属性
用法：`defer = "defer"`
只适用于外部脚本文件，表明脚本在执行时不会影响页面的构造
设置defer属性相当于告诉浏览器立即下载，但延迟到整个页面都解析完毕后再执行（浏览器遇到`</html>`标签）
HTML5规范要求脚本按出现的先后顺序执行，但在现实当中，延迟脚本不一定会按照顺序执行，也不一定会在DOMContentLoaded事件触发前执行，因此最好只包含一个延迟脚本**

###### 1.2.3 异步脚本
**async属性
用法：`async`
只适用于外部脚本文件，告诉浏览器立即下载文件
指定async的目的是不让页面等待多个脚本的下载和执行，从而异步加载页面其他内容。为此建议不要在加载异步脚本期间修改DOM
标记为async的脚本并不保证按照指定它们的先后顺序执行，因此确保指定为async的多个外部文件互不依赖
异步脚本一定会在页面的load事件前执行，但可能会在DOMContentLoaded事件触发之前或之后执行**

#### 2. 嵌入代码与外部文件
使用外部文件来包含JavaScript代码
- 可维护性。
- 可缓存。如果两个页面都使用同一个文件，那么这个文件只需要下载一次，可加快页面加载的速度。
- 适应未来。

#### 3. 文档模式
**通过使用文档类型doctype实现
如果没有doctype，所有浏览器默认开启混杂模式，但不同浏览器在该模式下行为差异非常大，跨浏览器的行为基本无一致性可言
主要影响CSS内容的呈现，但在某些情况下也会影响到JavaScript的解释执行**
- 混杂模式
- 准标准模式
- 标准模式
准标准模式与标准模式非常接近，差异几乎可以忽略不计，检测文档模式时也不会发现什么不同。

#### 4. noscript元素
**用以在不支持JavaScript的浏览器中显示替代的内容**
包含在`<noscript>`标签中的内容只有在下列情况下才会显示出来：
- 浏览器不支持脚本
- 脚本被禁用
除上述条件之外的情况下，浏览器不会呈现`<noscript>`元素中的内容
```
<html>
	<head>
    <title>Example HTML Page</title>
    <script type="text/javascript" defer="defer" src="example1.js"></script>
    <script type="text/javascript" defer="defer" src="example2.js"></script>
    </head>
    <body>
    	<!-- HTML  Page Content -->
    	<noscript>
        	<p>本页面需要浏览器支持（启用）JavaScript.</p>
        </noscript>
    </body>
</html>
```
这个页面会在脚本无效的情况下向用户显示一条信息。在启用了脚本的浏览器中则不会

#### 5. 小结
使用`<script>`插入JavaScript脚本，可嵌入到页面中，也可包含外部的JavaScript文件。
- src属性为文件的URL。可以是同一服务器上的文件，也可以是其他任何域中的文件
- 所有`<script>`元素按照出现的先后顺序被依次解析。
- 由于浏览器会先解析完不使用defer属性的`<script>`元素中的代码，然后再解析后面的内容。所以把`<script>`元素放在`</body>`标签前面
- defer可以让脚本在文档完全呈现之后再执行。延迟脚本总是按照指定他们的顺序执行。
- async表示当前脚本不必等待其他脚本，也不必阻塞文档呈现。不能保证异步脚本按照它们在页面中出现的顺序执行。
- `<noscript>`元素可以指定在不支持脚本的浏览器中显示的替代内容。启用脚本的情况下不会显示`<noscript>`元素中的任何内容。